<!DOCTYPE HTML>
<html lang="ko" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>진단(Diagnostics) 구현 - FunLang LSP 튜토리얼</title>


        <!-- Custom HTML head -->

        <meta name="description" content="F#으로 만드는 Language Server — LSP 입문자를 위한 단계별 한국어 튜토리얼">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-18d22713.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-b67c2577.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">FunLang LSP 튜토리얼</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="진단diagnostics-구현"><a class="header" href="#진단diagnostics-구현">진단(Diagnostics) 구현</a></h1>
<p>이 문서는 LSP 서버에서 <strong>Diagnostics</strong>(진단)를 구현하는 방법을 설명합니다. 진단은 에디터에 빨간 줄로 표시되는 에러와 경고를 말하며, LSP의 가장 중요한 기능 중 하나입니다.</p>
<h2 id="목차"><a class="header" href="#목차">목차</a></h2>
<ol>
<li><a href="#진단이란">진단이란</a></li>
<li><a href="#funlang의-diagnostic-시스템">FunLang의 Diagnostic 시스템</a></li>
<li><a href="#위치-변환-span--lsp-range">위치 변환: Span → LSP Range</a></li>
<li><a href="#문법-오류-처리">문법 오류 처리</a></li>
<li><a href="#타입-오류-처리">타입 오류 처리</a></li>
<li><a href="#publishdiagnostics-호출">publishDiagnostics 호출</a></li>
<li><a href="#진단-클리어">진단 클리어</a></li>
<li><a href="#테스트-작성">테스트 작성</a></li>
</ol>
<hr>
<h2 id="진단이란"><a class="header" href="#진단이란">진단이란</a></h2>
<p><strong>Diagnostics</strong>는 소스 코드의 문제를 사용자에게 알려주는 LSP 메시지입니다.</p>
<h3 id="진단의-구성-요소"><a class="header" href="#진단의-구성-요소">진단의 구성 요소</a></h3>
<pre><code class="language-typescript">interface Diagnostic {
    range: Range                    // 에러가 발생한 위치
    severity: DiagnosticSeverity   // Error, Warning, Info, Hint
    code?: string | number          // 에러 코드 (예: "E0301")
    source?: string                 // 진단 출처 (예: "funlang")
    message: string                 // 에러 메시지
    relatedInformation?: DiagnosticRelatedInformation[]  // 관련 위치
}
</code></pre>
<h3 id="vs-code에서의-표시"><a class="header" href="#vs-code에서의-표시">VS Code에서의 표시</a></h3>
<pre><code>test.fun
────────
1 | let x = 1 + true
              ~~~~ Error: Type mismatch: expected int but got bool [funlang]
</code></pre>
<ul>
<li><strong>빨간 밑줄</strong>: <code>range</code>로 지정된 영역</li>
<li><strong>에러 메시지</strong>: 마우스 호버 시 <code>message</code> 표시</li>
<li><strong>Problems 패널</strong>: 모든 진단이 목록으로 표시</li>
</ul>
<h3 id="publishdiagnostics-알림"><a class="header" href="#publishdiagnostics-알림">publishDiagnostics 알림</a></h3>
<p>LSP 서버는 <code>textDocument/publishDiagnostics</code> 알림을 클라이언트(에디터)로 보냅니다.</p>
<p><strong>중요:</strong> 이것은 **알림(Notification)**이지 요청(Request)이 아닙니다. 따라서 응답을 기다리지 않습니다.</p>
<pre><code class="language-fsharp">// 진단 발행 예시
let publishParams : PublishDiagnosticsParams = {
    Uri = "file:///test.fun"
    Diagnostics = [| diagnostic1; diagnostic2 |]
    Version = None
}
lspClient.TextDocumentPublishDiagnostics publishParams
</code></pre>
<pre class="mermaid">sequenceDiagram
    participant C as Client
    participant S as Server
    C-&gt;&gt;S: textDocument/didOpen(uri, text)
    Note over S: 파싱 → 타입 검사
    S--&gt;&gt;C: textDocument/publishDiagnostics(uri, diagnostics[])
    C-&gt;&gt;S: textDocument/didChange(uri, changes[])
    Note over S: 재파싱 → 재검사
    S--&gt;&gt;C: textDocument/publishDiagnostics(uri, diagnostics[])
</pre>

<hr>
<h2 id="funlang의-diagnostic-시스템"><a class="header" href="#funlang의-diagnostic-시스템">FunLang의 Diagnostic 시스템</a></h2>
<p>FunLang 컴파일러는 이미 풍부한 진단 시스템을 갖추고 있습니다.</p>
<h3 id="funlang-diagnostic-타입"><a class="header" href="#funlang-diagnostic-타입">FunLang Diagnostic 타입</a></h3>
<pre><code class="language-fsharp">// Diagnostic.fs (FunLang 프로젝트)
type Diagnostic = {
    Code: string option           // 예: Some "E0301"
    Message: string               // 에러 메시지
    PrimarySpan: Span             // 주 에러 위치
    SecondarySpans: (Span * string) list  // 관련 위치와 레이블
    Notes: string list            // 추가 설명
    Hint: string option           // 수정 제안
}
</code></pre>
<h3 id="span-타입-소스-위치"><a class="header" href="#span-타입-소스-위치">Span 타입 (소스 위치)</a></h3>
<pre><code class="language-fsharp">// Ast.fs (FunLang 프로젝트)
type Span = {
    FileName: string
    StartLine: int      // 0-based (LexBuffer.FromString 사용 시)
    StartColumn: int    // 0-based
    EndLine: int
    EndColumn: int      // exclusive (마지막 문자 다음 위치)
}
</code></pre>
<p><strong>참고:</strong> <code>LexBuffer.FromString</code>으로 파싱하면 Position이 <strong>0-based</strong>로 생성됩니다. LSP도 0-based이므로 <strong>변환이 필요 없습니다</strong>.</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>인덱싱</th><th>첫 번째 라인</th><th>첫 번째 문자</th></tr>
</thead>
<tbody>
<tr><td>FunLang Span (LexBuffer.FromString)</td><td>0</td><td>0</td></tr>
<tr><td>LSP Position</td><td>0</td><td>0</td></tr>
</tbody>
</table>
</div>
<h3 id="typecheck-모듈과의-통합"><a class="header" href="#typecheck-모듈과의-통합">TypeCheck 모듈과의 통합</a></h3>
<p>FunLang의 <code>TypeCheck</code> 모듈은 타입 체킹 결과를 <code>Result&lt;Type, Diagnostic&gt;</code>로 반환합니다.</p>
<pre><code class="language-fsharp">// TypeCheck.fs (FunLang 프로젝트)
let typecheckWithDiagnostic (expr: Expr) : Result&lt;Type, Diagnostic&gt; =
    try
        let ty = typecheck expr
        Ok ty
    with
    | TypeException error -&gt;
        let diag = typeErrorToDiagnostic error
        Error diag
</code></pre>
<p>이것을 LSP 서버에서 그대로 활용할 수 있습니다!</p>
<hr>
<h2 id="위치-변환-span--lsp-range"><a class="header" href="#위치-변환-span--lsp-range">위치 변환: Span → LSP Range</a></h2>
<p><code>LexBuffer.FromString</code>을 사용하면 Span이 이미 0-based이므로, 변환 없이 직접 사용합니다.</p>
<h3 id="변환-로직"><a class="header" href="#변환-로직">변환 로직</a></h3>
<pre><code class="language-fsharp">// Protocol.fs
module LangLSP.Server.Protocol

open Ionide.LanguageServerProtocol.Types
open Ast  // FunLang's Span type

/// Convert FunLang Span to LSP Range
/// LexBuffer.FromString creates 0-based positions, matching LSP
/// So no conversion needed
let spanToLspRange (span: Span) : Range =
    {
        Start = { Line = uint32 span.StartLine; Character = uint32 span.StartColumn }
        End = { Line = uint32 span.EndLine; Character = uint32 span.EndColumn }
    }
</code></pre>
<p><strong>핵심 포인트:</strong></p>
<ol>
<li><code>LexBuffer.FromString</code>이 생성하는 Position은 0-based (LSP와 동일)</li>
<li>별도의 변환이 필요 없음</li>
<li>FsLexYacc 문서에 1-based라고 되어 있지만, <code>LexBuffer.FromString</code>은 실제로 0-based</li>
</ol>
<h3 id="변환-예시"><a class="header" href="#변환-예시">변환 예시</a></h3>
<pre><code class="language-fsharp">// FunLang Span (0-based)
let span = { FileName = "test.fun"; StartLine = 2; StartColumn = 4; EndLine = 2; EndColumn = 9 }

// LSP Range (0-based) — 동일한 값
let range = spanToLspRange span
// { Start = { Line = 2u; Character = 4u }; End = { Line = 2u; Character = 9u } }
</code></pre>
<h3 id="funlang-diagnostic--lsp-diagnostic"><a class="header" href="#funlang-diagnostic--lsp-diagnostic">FunLang Diagnostic → LSP Diagnostic</a></h3>
<pre><code class="language-fsharp">/// Convert FunLang Diagnostic to LSP Diagnostic
let diagnosticToLsp (diag: Diagnostic.Diagnostic) : Diagnostic =
    {
        Range = spanToLspRange diag.PrimarySpan
        Severity = Some DiagnosticSeverity.Error
        Code = None  // Will be enhanced later with error codes
        CodeDescription = None
        Source = Some "funlang"
        Message = diag.Message
        Tags = None
        RelatedInformation =
            if List.isEmpty diag.SecondarySpans then None
            else
                diag.SecondarySpans
                |&gt; List.map (fun (span, label) -&gt;
                    {
                        Location = {
                            Uri = span.FileName  // Will need URI conversion later
                            Range = spanToLspRange span
                        }
                        Message = label
                    })
                |&gt; Array.ofList
                |&gt; Some
        Data = None
    }
</code></pre>
<p><strong>RelatedInformation 활용:</strong></p>
<ul>
<li>FunLang의 <code>SecondarySpans</code>를 LSP의 <code>RelatedInformation</code>으로 매핑</li>
<li>에디터에서 “관련 위치 보기” 기능 제공</li>
</ul>
<hr>
<h2 id="문법-오류-처리"><a class="header" href="#문법-오류-처리">문법 오류 처리</a></h2>
<p>파싱 단계에서 발생하는 문법 오류를 처리합니다.</p>
<h3 id="파싱-로직"><a class="header" href="#파싱-로직">파싱 로직</a></h3>
<pre><code class="language-fsharp">// Diagnostics.fs
module LangLSP.Server.Diagnostics

open System
open FSharp.Text.Lexing
open Ionide.LanguageServerProtocol
open Ionide.LanguageServerProtocol.Types
open LangLSP.Server.Protocol

/// Parse FunLang source code and catch syntax errors
/// Returns Ok(ast) on success, Error(diagnostic) on parse error
let parseFunLang (source: string) (uri: string) : Result&lt;Ast.Expr, Diagnostic&gt; =
    try
        let lexbuf = LexBuffer&lt;char&gt;.FromString(source)
        let ast = Parser.start Lexer.tokenize lexbuf
        Ok ast
    with
    | ex -&gt;
        // Parse error - create a diagnostic
        // fsyacc exceptions contain position info in the message
        let message =
            if ex.Message.Contains("parse error") then
                "Syntax error: " + ex.Message
            else
                "Parse error: " + ex.Message

        // Create a span from lexbuf position (0-based)
        let startPos = lexbuf.StartPos
        let endPos = lexbuf.EndPos
        let span : Ast.Span = {
            FileName = uri
            StartLine = startPos.Line
            StartColumn = startPos.Column
            EndLine = endPos.Line
            EndColumn = endPos.Column
        }

        let diag: Diagnostic = {
            Range = spanToLspRange span
            Severity = Some DiagnosticSeverity.Error
            Code = None
            CodeDescription = None
            Source = Some "funlang"
            Message = message
            Tags = None
            RelatedInformation = None
            Data = None
        }
        Error diag
</code></pre>
<p><strong>핵심 포인트:</strong></p>
<ul>
<li><strong>try-catch</strong>: fsyacc 파서는 예외를 던지므로 catch 필요</li>
<li><strong>lexbuf 위치 사용</strong>: 파싱 실패 시 <code>lexbuf.StartPos</code>/<code>EndPos</code>에서 에러 위치 추출 (0-based)</li>
<li><strong>Error 반환</strong>: <code>Result&lt;Ast.Expr, Diagnostic&gt;</code> 타입으로 파싱 실패 전달</li>
</ul>
<h3 id="문법-오류-예시"><a class="header" href="#문법-오류-예시">문법 오류 예시</a></h3>
<pre><code class="language-fsharp">// 입력: "let x = "  (incomplete let expression)
let source = "let x = "
let result = parseFunLang source "file:///test.fun"

// 결과:
// Error { Range = { Start = (0, 0), End = (0, 0) }; Message = "Syntax error: ..." }
</code></pre>
<hr>
<h2 id="타입-오류-처리"><a class="header" href="#타입-오류-처리">타입 오류 처리</a></h2>
<p>AST를 파싱한 후 타입 체킹을 수행합니다.</p>
<h3 id="타입-체킹-로직"><a class="header" href="#타입-체킹-로직">타입 체킹 로직</a></h3>
<pre><code class="language-fsharp">/// Type check AST using FunLang's type checker
/// Returns Ok(type) on success, Error(diagnostic) on type error
let typecheckAst (ast: Ast.Expr) : Result&lt;Type.Type, Diagnostic&gt; =
    match TypeCheck.typecheckWithDiagnostic ast with
    | Ok ty -&gt; Ok ty
    | Error funlangDiag -&gt;
        // Convert FunLang diagnostic to LSP diagnostic
        let lspDiag = diagnosticToLsp funlangDiag
        Error lspDiag
</code></pre>
<p><strong>동작:</strong></p>
<ol>
<li>FunLang의 <code>typecheckWithDiagnostic</code> 호출</li>
<li>성공 시 타입 반환, 실패 시 FunLang Diagnostic 반환</li>
<li><code>diagnosticToLsp</code>로 LSP 형식으로 변환</li>
</ol>
<h3 id="타입-오류-예시"><a class="header" href="#타입-오류-예시">타입 오류 예시</a></h3>
<pre><code class="language-fsharp">// 입력: "1 + true"  (type mismatch: int + bool)
let source = "1 + true"
let result = parseFunLang source "file:///test.fun"

match result with
| Ok ast -&gt;
    match typecheckAst ast with
    | Ok ty -&gt; printfn "Type: %A" ty
    | Error diag -&gt;
        // diag.Message = "Type mismatch: expected int but got bool"
        printfn "Type error: %s" diag.Message
| Error parseDiag -&gt;
    printfn "Parse error: %s" parseDiag.Message
</code></pre>
<h3 id="funlang의-풍부한-타입-에러"><a class="header" href="#funlang의-풍부한-타입-에러">FunLang의 풍부한 타입 에러</a></h3>
<p>FunLang의 Diagnostic 시스템은 다음을 제공합니다:</p>
<ol>
<li><strong>PrimarySpan</strong>: 주 에러 위치</li>
<li><strong>SecondarySpans</strong>: 관련 위치 (예: 타입 annotation이 있는 곳)</li>
<li><strong>Notes</strong>: 컨텍스트 스택 (에러가 발생한 경로)</li>
<li><strong>Hint</strong>: 수정 제안</li>
</ol>
<p><strong>예시:</strong></p>
<pre><code>error[E0301]: Type mismatch: expected int but got bool
 --&gt; test.fun:1:5
   = in function position: test.fun:1:1
   = note: in if condition at test.fun:1:4
   = hint: Check that all branches of your expression return the same type
</code></pre>
<p>이 모든 정보가 LSP Diagnostic의 <code>Message</code>와 <code>RelatedInformation</code>으로 변환됩니다!</p>
<hr>
<h2 id="publishdiagnostics-호출"><a class="header" href="#publishdiagnostics-호출">publishDiagnostics 호출</a></h2>
<p>전체 분석 파이프라인을 구성합니다.</p>
<h3 id="analyze-함수"><a class="header" href="#analyze-함수">analyze 함수</a></h3>
<pre><code class="language-fsharp">/// Analyze document and return all diagnostics
/// Returns list of diagnostics (empty if no errors)
let analyze (uri: string) (source: string) : Diagnostic list =
    match parseFunLang source uri with
    | Error parseDiag -&gt;
        // Parse error - stop here, don't try to typecheck
        [parseDiag]
    | Ok ast -&gt;
        // Parse succeeded, now typecheck
        match typecheckAst ast with
        | Ok _ -&gt;
            // No errors
            []
        | Error typeDiag -&gt;
            // Type error
            [typeDiag]
</code></pre>
<p><strong>파이프라인:</strong></p>
<ol>
<li>파싱 시도
<ul>
<li>실패 → 파싱 에러 반환, 타입 체킹 스킵</li>
<li>성공 → 타입 체킹 진행</li>
</ul>
</li>
<li>타입 체킹 시도
<ul>
<li>성공 → 빈 리스트 (에러 없음)</li>
<li>실패 → 타입 에러 반환</li>
</ul>
</li>
</ol>
<h3 id="publishdiagnostics-함수"><a class="header" href="#publishdiagnostics-함수">publishDiagnostics 함수</a></h3>
<pre><code class="language-fsharp">/// Publish diagnostics to client
let publishDiagnostics (lspClient: ILspClient) (uri: string) (diagnostics: Diagnostic list) : Async&lt;unit&gt; =
    async {
        let publishParams: PublishDiagnosticsParams = {
            Uri = uri
            Diagnostics = Array.ofList diagnostics
            Version = None
        }
        do! lspClient.TextDocumentPublishDiagnostics publishParams
    }
</code></pre>
<p><strong>사용 예시:</strong></p>
<pre><code class="language-fsharp">// DocumentSync에서 didChange 이후 호출
let handleDidChangeWithDiagnostics (lspClient: ILspClient) (p: DidChangeTextDocumentParams) : Async&lt;unit&gt; =
    async {
        // 1. 문서 동기화
        DocumentSync.handleDidChange p

        // 2. 업데이트된 텍스트 가져오기
        match DocumentSync.getDocument p.TextDocument.Uri with
        | Some source -&gt;
            // 3. 분석 및 진단 발행
            let diagnostics = Diagnostics.analyze p.TextDocument.Uri source
            do! Diagnostics.publishDiagnostics lspClient p.TextDocument.Uri diagnostics
        | None -&gt;
            // 문서가 추적되지 않음 (오류 상황)
            ()
    }
</code></pre>
<hr>
<h2 id="진단-클리어"><a class="header" href="#진단-클리어">진단 클리어</a></h2>
<p>문서를 닫거나 에러가 수정되었을 때 진단을 클리어해야 합니다.</p>
<h3 id="cleardiagnostics-함수"><a class="header" href="#cleardiagnostics-함수">clearDiagnostics 함수</a></h3>
<pre><code class="language-fsharp">/// Clear diagnostics for a document
let clearDiagnostics (lspClient: ILspClient) (uri: string) : Async&lt;unit&gt; =
    publishDiagnostics lspClient uri []
</code></pre>
<p><strong>핵심 아이디어:</strong> 빈 진단 배열을 발행하면 기존 진단이 모두 제거됩니다.</p>
<h3 id="사용-시나리오"><a class="header" href="#사용-시나리오">사용 시나리오</a></h3>
<ol>
<li>
<p><strong>파일 닫기:</strong></p>
<pre><code class="language-fsharp">let handleDidCloseWithDiagnostics (lspClient: ILspClient) (p: DidCloseTextDocumentParams) : Async&lt;unit&gt; =
    async {
        DocumentSync.handleDidClose p
        do! Diagnostics.clearDiagnostics lspClient p.TextDocument.Uri
    }
</code></pre>
</li>
<li>
<p><strong>에러 수정:</strong></p>
<pre><code class="language-fsharp">// 사용자가 코드를 수정하여 에러가 없어지면 analyze 함수가 빈 리스트 반환
let diagnostics = analyze uri source  // []
do! publishDiagnostics lspClient uri diagnostics  // 진단 클리어
</code></pre>
</li>
</ol>
<hr>
<h2 id="테스트-작성"><a class="header" href="#테스트-작성">테스트 작성</a></h2>
<p>Expecto와 FsCheck를 활용하여 진단 기능을 테스트합니다.</p>
<h3 id="기본-테스트"><a class="header" href="#기본-테스트">기본 테스트</a></h3>
<pre><code class="language-fsharp">// DiagnosticsTests.fs
module LangLSP.Tests.DiagnosticsTests

open Expecto
open LangLSP.Server.Diagnostics
open Ionide.LanguageServerProtocol.Types

[&lt;Tests&gt;]
let diagnosticsTests =
    testList "Diagnostics" [

        testCase "valid code produces no diagnostics" &lt;| fun _ -&gt;
            let source = "1 + 2"
            let uri = "file:///test.fun"
            let diagnostics = analyze uri source
            Expect.isEmpty diagnostics "Valid code should produce no diagnostics"

        testCase "syntax error produces diagnostic" &lt;| fun _ -&gt;
            let source = "let x = "  // incomplete let expression
            let uri = "file:///test.fun"
            let diagnostics = analyze uri source
            Expect.isNonEmpty diagnostics "Syntax error should produce diagnostic"
            let diag = diagnostics.[0]
            Expect.equal diag.Source (Some "funlang") "Source should be 'funlang'"
            Expect.equal diag.Severity (Some DiagnosticSeverity.Error) "Severity should be Error"
            Expect.stringContains (diag.Message.ToLower()) "error" "Message should mention error"

        testCase "type error produces diagnostic (Int + Bool)" &lt;| fun _ -&gt;
            let source = "1 + true"  // type mismatch: int + bool
            let uri = "file:///test.fun"
            let diagnostics = analyze uri source
            Expect.isNonEmpty diagnostics "Type error should produce diagnostic"
            let diag = diagnostics.[0]
            Expect.equal diag.Source (Some "funlang") "Source should be 'funlang'"
            Expect.equal diag.Severity (Some DiagnosticSeverity.Error) "Severity should be Error"
            // Type checker should mention type mismatch
            Expect.isTrue (diag.Message.Contains("type") || diag.Message.Contains("Type"))
                "Message should mention type"

        testCase "unbound variable produces diagnostic" &lt;| fun _ -&gt;
            let source = "x + 1"  // x is not defined
            let uri = "file:///test.fun"
            let diagnostics = analyze uri source
            Expect.isNonEmpty diagnostics "Unbound variable should produce diagnostic"
            let diag = diagnostics.[0]
            Expect.equal diag.Source (Some "funlang") "Source should be 'funlang'"
            Expect.equal diag.Severity (Some DiagnosticSeverity.Error) "Severity should be Error"
            Expect.isTrue (diag.Message.Contains("Unbound") || diag.Message.Contains("unbound"))
                "Message should mention unbound variable"
    ]
</code></pre>
<h3 id="protocol-변환-테스트-fscheck"><a class="header" href="#protocol-변환-테스트-fscheck">Protocol 변환 테스트 (FsCheck)</a></h3>
<pre><code class="language-fsharp">// ProtocolTests.fs
module LangLSP.Tests.ProtocolTests

open Expecto
open Expecto.ExpectoFsCheck
open FsCheck
open LangLSP.Server.Protocol

/// Generator for valid Span values
/// FunLang Span is 0-based (from LexBuffer.FromString), and start &lt;= end
let validSpanGen : Gen&lt;Ast.Span&gt; =
    gen {
        let! startLine = Gen.choose(0, 999)
        let! startColumn = Gen.choose(0, 199)
        let! endLine = Gen.choose(startLine, 999)
        // If on same line, endColumn &gt;= startColumn
        // If on different line, endColumn can be anything
        let! endColumn =
            if endLine = startLine then
                Gen.choose(startColumn, 200)
            else
                Gen.choose(0, 200)

        let span : Ast.Span = {
            FileName = "test.fun"
            StartLine = startLine
            StartColumn = startColumn
            EndLine = endLine
            EndColumn = endColumn
        }
        return span
    }

/// Arbitrary instance for valid Spans
type ValidSpanArbitrary =
    static member Span() = Arb.fromGen validSpanGen

[&lt;Tests&gt;]
let protocolTests =
    // Configure FsCheck to run 500 test cases
    let fsCheckConfig = { FsCheckConfig.defaultConfig with maxTest = 500; arbitrary = [typeof&lt;ValidSpanArbitrary&gt;] }

    testList "Protocol" [

        testPropertyWithConfig fsCheckConfig "spanToLspRange preserves 0-based values" &lt;| fun (span: Ast.Span) -&gt;
            let range = spanToLspRange span
            // Both FunLang (LexBuffer.FromString) and LSP are 0-based
            // Values should be passed through directly
            Expect.equal range.Start.Line (uint32 span.StartLine) "Start line should match"
            Expect.equal range.Start.Character (uint32 span.StartColumn) "Start char should match"
            Expect.equal range.End.Line (uint32 span.EndLine) "End line should match"
            Expect.equal range.End.Character (uint32 span.EndColumn) "End char should match"

        testPropertyWithConfig fsCheckConfig "spanToLspRange preserves line ordering" &lt;| fun (span: Ast.Span) -&gt;
            let range = spanToLspRange span
            // If start line &lt;= end line in source, it should remain so in LSP
            Expect.isLessThanOrEqual range.Start.Line range.End.Line "Start line should be &lt;= end line"

        testPropertyWithConfig fsCheckConfig "spanToLspRange same line preserves character ordering" &lt;| fun (span: Ast.Span) -&gt;
            let range = spanToLspRange span
            // If on same line, start character &lt;= end character
            if range.Start.Line = range.End.Line then
                Expect.isLessThanOrEqual range.Start.Character range.End.Character
                    "On same line, start char should be &lt;= end char"

        testCase "spanToLspRange edge case: invalid (0,0) span clamped" &lt;| fun _ -&gt;
            let span : Ast.Span = {
                FileName = "test.fun"
                StartLine = 0
                StartColumn = 0
                EndLine = 0
                EndColumn = 0
            }
            let range = spanToLspRange span
            // Invalid (0,0) span should be clamped to (0,0) instead of wrapping to uint.MaxValue
            Expect.equal range.Start.Line 0u "Invalid span start line should clamp to 0"
            Expect.equal range.Start.Character 0u "Invalid span start char should clamp to 0"
            Expect.equal range.End.Line 0u "Invalid span end line should clamp to 0"
            Expect.equal range.End.Character 0u "Invalid span end char should clamp to 0"
    ]
</code></pre>
<p><strong>FsCheck 활용 포인트:</strong></p>
<ul>
<li><strong>Property-based Testing</strong>: 500개의 랜덤 Span을 생성하여 변환 함수 검증</li>
<li><strong>불변식(Invariants)</strong> 검증:
<ol>
<li>1-based → 0-based 변환 정확성</li>
<li>줄 순서 보존 (startLine ≤ endLine)</li>
<li>같은 줄에서 문자 순서 보존</li>
<li>Edge case: (0,0) span clamp 처리</li>
</ol>
</li>
</ul>
<h3 id="테스트-실행"><a class="header" href="#테스트-실행">테스트 실행</a></h3>
<pre><code class="language-bash">dotnet run --project src/LangLSP.Tests

# 출력:
# [Diagnostics] valid code produces no diagnostics - Passed
# [Diagnostics] syntax error produces diagnostic - Passed
# [Diagnostics] type error produces diagnostic (Int + Bool) - Passed
# [Diagnostics] unbound variable produces diagnostic - Passed
# [Protocol] spanToLspRange converts to 0-based (500 test cases) - Passed
# [Protocol] spanToLspRange preserves line ordering (500 test cases) - Passed
# [Protocol] spanToLspRange same line preserves character ordering (500 test cases) - Passed
# [Protocol] spanToLspRange edge case: invalid (0,0) span clamped - Passed
</code></pre>
<hr>
<h2 id="다음-단계"><a class="header" href="#다음-단계">다음 단계</a></h2>
<p>진단 시스템이 완료되었으므로, 이제 사용자는 에디터에서 실시간 에러 피드백을 받을 수 있습니다!</p>
<p><strong>Phase 1 완료!</strong> 다음 Phase에서는 더 고급 기능을 구현합니다:</p>
<h3 id="phase-2---lsp-기능-확장"><a class="header" href="#phase-2---lsp-기능-확장">Phase 2 - LSP 기능 확장</a></h3>
<ol>
<li><strong>Hover</strong>: 커서 위치의 타입 정보 표시</li>
<li><strong>Completion</strong>: 자동완성 제안</li>
<li><strong>Go to Definition</strong>: 정의로 이동</li>
<li><strong>Find References</strong>: 참조 찾기</li>
<li><strong>Rename</strong>: 심볼 이름 변경</li>
<li><strong>Code Actions</strong>: 빠른 수정 제안</li>
</ol>
<h3 id="vs-code-확장-배포"><a class="header" href="#vs-code-확장-배포">VS Code 확장 배포</a></h3>
<ul>
<li><code>vsce package</code>로 <code>.vsix</code> 파일 생성</li>
<li>VS Code Marketplace에 배포</li>
<li>사용자가 에디터에서 바로 설치 가능</li>
</ul>
<hr>
<h2 id="참고-자료"><a class="header" href="#참고-자료">참고 자료</a></h2>
<ul>
<li><a href="https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnostic">LSP Specification - Diagnostics</a></li>
<li><a href="https://github.com/kodu-ai/LangTutorial/blob/main/FunLang/Diagnostic.fs">FunLang Diagnostic 시스템</a></li>
<li><a href="https://github.com/haf/expecto">Expecto 문서</a></li>
<li><a href="https://fscheck.github.io/FsCheck/">FsCheck 문서</a></li>
</ul>
<hr>
<p><strong>→ 다음: Phase 2 - Hover 구현</strong> - 타입 정보 표시</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="04-document-sync.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="06-hover.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="04-document-sync.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="06-hover.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid-eefea253.min.js"></script>
        <script src="mermaid-init-ccf746f1.js"></script>



    </div>
    </body>
</html>
