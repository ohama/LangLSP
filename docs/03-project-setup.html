<!DOCTYPE HTML>
<html lang="ko" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>F# 프로젝트 설정 - FunLang LSP 튜토리얼</title>


        <!-- Custom HTML head -->

        <meta name="description" content="F#으로 만드는 Language Server — LSP 입문자를 위한 단계별 한국어 튜토리얼">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-18d22713.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-b67c2577.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">FunLang LSP 튜토리얼</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="f-프로젝트-설정"><a class="header" href="#f-프로젝트-설정">F# 프로젝트 설정</a></h1>
<p>이 문서는 F# LSP 서버 프로젝트를 처음부터 만드는 방법을 단계별로 설명합니다. 이 튜토리얼을 따라하면 FunLang LSP 서버의 전체 프로젝트 구조를 생성할 수 있습니다.</p>
<h3 id="lsp-initialize-핸드셰이크"><a class="header" href="#lsp-initialize-핸드셰이크">LSP Initialize 핸드셰이크</a></h3>
<pre class="mermaid">sequenceDiagram
    participant C as Client (VS Code)
    participant S as Server (LangLSP)
    C-&gt;&gt;S: initialize(processId, capabilities, rootUri)
    S-&gt;&gt;C: InitializeResult(serverCapabilities)
    C-&gt;&gt;S: initialized()
    Note over C,S: 서버 준비 완료, 문서 이벤트 수신 대기
</pre>

<h2 id="목차"><a class="header" href="#목차">목차</a></h2>
<ol>
<li><a href="#사전-요구사항">사전 요구사항</a></li>
<li><a href="#프로젝트-구조-개요">프로젝트 구조 개요</a></li>
<li><a href="#f-프로젝트-생성">F# 프로젝트 생성</a></li>
<li><a href="#nuget-패키지-설치">NuGet 패키지 설치</a></li>
<li><a href="#funlang-서브모듈-연결">FunLang 서브모듈 연결</a></li>
<li><a href="#프로젝트-파일-구성">프로젝트 파일 구성</a></li>
<li><a href="#테스트-프로젝트-설정">테스트 프로젝트 설정</a></li>
<li><a href="#빌드-및-실행-확인">빌드 및 실행 확인</a></li>
</ol>
<hr>
<h2 id="사전-요구사항"><a class="header" href="#사전-요구사항">사전 요구사항</a></h2>
<p>프로젝트를 시작하기 전에 다음 도구들이 설치되어 있어야 합니다.</p>
<h3 id="1-net-10-sdk"><a class="header" href="#1-net-10-sdk">1. .NET 10 SDK</a></h3>
<pre><code class="language-bash"># .NET 버전 확인
dotnet --version
# 출력: 10.0.x 이상
</code></pre>
<p><strong>설치 방법</strong>: <a href="https://dotnet.microsoft.com/download">.NET 공식 사이트</a>에서 .NET 10 SDK 다운로드</p>
<h3 id="2-vs-code"><a class="header" href="#2-vs-code">2. VS Code</a></h3>
<p><strong>추천 확장 프로그램:</strong></p>
<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=Ionide.Ionide-fsharp">Ionide for F#</a> - F# 개발 도구</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=Ionide.Ionide-fsharp">F# (FsAutoComplete)</a> - F# LSP 클라이언트</li>
</ul>
<h3 id="3-git"><a class="header" href="#3-git">3. Git</a></h3>
<p>서브모듈 관리를 위해 Git이 필요합니다.</p>
<pre><code class="language-bash"># Git 버전 확인
git --version
</code></pre>
<hr>
<h2 id="프로젝트-구조-개요"><a class="header" href="#프로젝트-구조-개요">프로젝트 구조 개요</a></h2>
<p>우리가 만들 프로젝트의 전체 구조는 다음과 같습니다.</p>
<pre><code>LangLSP/
├── src/
│   ├── LangLSP.Server/      # F# LSP 서버 프로젝트
│   │   ├── Protocol.fs      # LSP 타입 변환 (Span ↔ Range)
│   │   ├── Server.fs        # 서버 capabilities 선언
│   │   ├── Program.fs       # 진입점 (stdin/stdout 설정)
│   │   └── LangLSP.Server.fsproj
│   └── LangLSP.Tests/       # 테스트 프로젝트 (Phase 2에서 추가)
├── client/                   # VS Code 확장 프로젝트 (Phase 3에서 추가)
├── LangTutorial/            # FunLang 서브모듈 (컴파일러 재사용)
│   └── FunLang/
│       ├── Ast.fs           # Span 타입 (소스 위치)
│       ├── Diagnostic.fs    # 에러 메시지 타입
│       ├── Lexer.fs         # 어휘 분석
│       ├── Parser.fs        # 구문 분석
│       └── TypeChecker.fs   # 타입 체커
├── documentation/tutorial/           # 이 튜토리얼 문서들
└── LangLSP.sln              # 솔루션 파일
</code></pre>
<hr>
<h2 id="f-프로젝트-생성"><a class="header" href="#f-프로젝트-생성">F# 프로젝트 생성</a></h2>
<h3 id="1-솔루션-생성"><a class="header" href="#1-솔루션-생성">1. 솔루션 생성</a></h3>
<p>먼저 프로젝트 디렉토리를 만들고 솔루션을 생성합니다.</p>
<pre><code class="language-bash"># 프로젝트 디렉토리 생성
mkdir LangLSP
cd LangLSP

# 솔루션 파일 생성
dotnet new sln -n LangLSP
</code></pre>
<p>생성된 <code>LangLSP.sln</code> 파일은 여러 F# 프로젝트를 하나로 묶어주는 역할을 합니다.</p>
<h3 id="2-서버-프로젝트-생성"><a class="header" href="#2-서버-프로젝트-생성">2. 서버 프로젝트 생성</a></h3>
<p>LSP 서버를 담을 F# 콘솔 프로젝트를 생성합니다.</p>
<pre><code class="language-bash"># 디렉토리 생성
mkdir -p src/LangLSP.Server
cd src/LangLSP.Server

# F# 콘솔 프로젝트 생성
dotnet new console -lang F# -n LangLSP.Server

# 루트로 돌아가기
cd ../..
</code></pre>
<p><strong>왜 콘솔 프로젝트인가?</strong></p>
<ul>
<li>LSP 서버는 stdin/stdout을 통해 에디터와 통신합니다</li>
<li>별도 프로세스로 실행되며, CLI 도구처럼 동작합니다</li>
</ul>
<h3 id="3-솔루션에-프로젝트-추가"><a class="header" href="#3-솔루션에-프로젝트-추가">3. 솔루션에 프로젝트 추가</a></h3>
<pre><code class="language-bash"># 서버 프로젝트를 솔루션에 추가
dotnet sln add src/LangLSP.Server/LangLSP.Server.fsproj
</code></pre>
<p>솔루션에 추가하면 VS Code에서 전체 프로젝트를 한 번에 빌드하고 관리할 수 있습니다.</p>
<hr>
<h2 id="nuget-패키지-설치"><a class="header" href="#nuget-패키지-설치">NuGet 패키지 설치</a></h2>
<p>LSP 서버에 필요한 NuGet 패키지들을 설치합니다.</p>
<pre><code class="language-bash">cd src/LangLSP.Server

# Ionide.LanguageServerProtocol: LSP 프로토콜 구현
dotnet add package Ionide.LanguageServerProtocol --version 0.7.0

# Serilog: 구조화된 로깅
dotnet add package Serilog --version 4.2.0

# Serilog.Sinks.File: 파일 로깅
dotnet add package Serilog.Sinks.File --version 6.0.0

cd ../..
</code></pre>
<h3 id="패키지-역할-설명"><a class="header" href="#패키지-역할-설명">패키지 역할 설명</a></h3>
<h4 id="ionidelanguageserverprotocol-070"><a class="header" href="#ionidelanguageserverprotocol-070">Ionide.LanguageServerProtocol (0.7.0)</a></h4>
<ul>
<li><strong>역할</strong>: LSP 프로토콜 구현 (JSON-RPC, LSP 타입)</li>
<li><strong>장점</strong>: F# 네이티브, FsAutoComplete에서 검증됨</li>
<li><strong>제공 기능</strong>:
<ul>
<li><code>Ionide.LanguageServerProtocol.Types</code> - LSP 타입 (Range, Position, Diagnostic 등)</li>
<li><code>Ionide.LanguageServerProtocol.Server</code> - 서버 구현 헬퍼</li>
</ul>
</li>
</ul>
<h4 id="serilog-420--sinksfile-600"><a class="header" href="#serilog-420--sinksfile-600">Serilog (4.2.0 + Sinks.File 6.0.0)</a></h4>
<ul>
<li><strong>역할</strong>: 디버깅용 구조화된 로깅</li>
<li><strong>왜 파일 로깅인가?</strong>: LSP 서버는 stdout을 프로토콜 통신에 사용하므로, 콘솔에 로그를 출력하면 프로토콜이 깨집니다</li>
<li><strong>로그 위치</strong>: <code>/tmp/funlang-lsp.log</code> (Linux/macOS) 또는 <code>%TEMP%</code> (Windows)</li>
</ul>
<hr>
<h2 id="funlang-서브모듈-연결"><a class="header" href="#funlang-서브모듈-연결">FunLang 서브모듈 연결</a></h2>
<p>FunLang 컴파일러 코드를 재사용하기 위해 Git 서브모듈로 추가합니다.</p>
<h3 id="1-서브모듈-추가"><a class="header" href="#1-서브모듈-추가">1. 서브모듈 추가</a></h3>
<pre><code class="language-bash"># 서브모듈로 FunLang 프로젝트 추가
git submodule add https://github.com/kodu-ai/LangTutorial.git

# 서브모듈 초기화 및 업데이트
git submodule update --init --recursive
</code></pre>
<h3 id="2-funlang-프로젝트-참조-추가"><a class="header" href="#2-funlang-프로젝트-참조-추가">2. FunLang 프로젝트 참조 추가</a></h3>
<pre><code class="language-bash"># LangLSP.Server에서 FunLang 프로젝트 참조
dotnet add src/LangLSP.Server/LangLSP.Server.fsproj reference LangTutorial/FunLang/FunLang.fsproj

# 솔루션에 FunLang 프로젝트도 추가
dotnet sln add LangTutorial/FunLang/FunLang.fsproj
</code></pre>
<h3 id="왜-서브모듈인가"><a class="header" href="#왜-서브모듈인가">왜 서브모듈인가?</a></h3>
<p>FunLang 컴파일러는 이미 다음 기능들을 구현하고 있습니다.</p>
<p><strong>재사용할 모듈:</strong></p>
<ul>
<li><code>Ast.fs</code> - <strong>Span 타입</strong>: 소스 코드 위치 (Line, Column)</li>
<li><code>Diagnostic.fs</code> - <strong>진단 타입</strong>: 에러 메시지 구조</li>
<li><code>Lexer.fs</code>, <code>Parser.fs</code> - 구문 분석</li>
<li><code>TypeChecker.fs</code> - 타입 체킹 (LSP 진단에 사용)</li>
</ul>
<p><strong>Span 타입 예시:</strong></p>
<pre><code class="language-fsharp">// Ast.fs에서 정의됨
type Span = {
    FileName: string
    StartLine: int    // 1-based (사람이 읽는 방식)
    StartColumn: int  // 1-based
    EndLine: int
    EndColumn: int
}
</code></pre>
<p>LSP는 0-based Position을 사용하므로, Protocol.fs에서 변환 함수를 구현합니다.</p>
<pre><code class="language-fsharp">// Protocol.fs
let spanToLspRange (span: Span) : Range =
    {
        Start = { Line = uint32 (span.StartLine - 1); Character = uint32 (span.StartColumn - 1) }
        End = { Line = uint32 (span.EndLine - 1); Character = uint32 (span.EndColumn - 1) }
    }
</code></pre>
<hr>
<h2 id="프로젝트-파일-구성"><a class="header" href="#프로젝트-파일-구성">프로젝트 파일 구성</a></h2>
<p>F#은 <strong>파일 순서에 의존하는 언어</strong>입니다. F#에는 순방향 참조가 없으므로, 파일이 <code>.fsproj</code>에 나열된 순서대로 컴파일됩니다.</p>
<h3 id="f-컴파일-순서의-중요성"><a class="header" href="#f-컴파일-순서의-중요성">F# 컴파일 순서의 중요성</a></h3>
<pre><code class="language-fsharp">// Protocol.fs (먼저 컴파일)
module Protocol
let spanToLspRange (span: Span) : Range = ...

// Server.fs (나중에 컴파일)
module Server
open Protocol  // Protocol 모듈을 사용 가능
let serverCapabilities = ...
</code></pre>
<p>만약 <code>Server.fs</code>를 <code>Protocol.fs</code>보다 먼저 나열하면, 컴파일 에러가 발생합니다.</p>
<h3 id="langlspserverfsproj-구조"><a class="header" href="#langlspserverfsproj-구조">LangLSP.Server.fsproj 구조</a></h3>
<p>프로젝트 파일의 전체 내용은 다음과 같습니다.</p>
<pre><code class="language-xml">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;

  &lt;PropertyGroup&gt;
    &lt;OutputType&gt;Exe&lt;/OutputType&gt;
    &lt;TargetFramework&gt;net10.0&lt;/TargetFramework&gt;
  &lt;/PropertyGroup&gt;

  &lt;ItemGroup&gt;
    &lt;!-- F# 파일 컴파일 순서 (중요!) --&gt;
    &lt;Compile Include="Protocol.fs" /&gt;
    &lt;Compile Include="Server.fs" /&gt;
    &lt;Compile Include="Program.fs" /&gt;
  &lt;/ItemGroup&gt;

  &lt;ItemGroup&gt;
    &lt;PackageReference Include="Ionide.LanguageServerProtocol" Version="0.7.0" /&gt;
    &lt;PackageReference Include="Serilog" Version="4.2.0" /&gt;
    &lt;PackageReference Include="Serilog.Sinks.File" Version="6.0.0" /&gt;
  &lt;/ItemGroup&gt;

  &lt;ItemGroup&gt;
    &lt;ProjectReference Include="../../LangTutorial/FunLang/FunLang.fsproj" /&gt;
  &lt;/ItemGroup&gt;

&lt;/Project&gt;
</code></pre>
<h3 id="파일별-역할"><a class="header" href="#파일별-역할">파일별 역할</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>파일</th><th>역할</th><th>의존성</th></tr>
</thead>
<tbody>
<tr><td><code>Protocol.fs</code></td><td>Span ↔ LSP Range 변환 함수</td><td>FunLang.Ast, Ionide.Types</td></tr>
<tr><td><code>Server.fs</code></td><td>ServerCapabilities 선언</td><td>Ionide.Types</td></tr>
<tr><td><code>Program.fs</code></td><td>진입점, stdin/stdout 설정</td><td>Protocol, Server, Serilog</td></tr>
</tbody>
</table>
</div>
<p><strong>컴파일 순서 규칙:</strong></p>
<ul>
<li><code>Program.fs</code>는 항상 <strong>마지막</strong>에 위치 (진입점)</li>
<li><code>Protocol.fs</code>는 다른 모듈보다 <strong>먼저</strong> (유틸리티 함수)</li>
</ul>
<hr>
<h2 id="테스트-프로젝트-설정"><a class="header" href="#테스트-프로젝트-설정">테스트 프로젝트 설정</a></h2>
<p>LSP 서버의 기능을 테스트하기 위한 테스트 프로젝트를 추가합니다. (Phase 2에서 본격적으로 사용)</p>
<pre><code class="language-bash"># 테스트 프로젝트 디렉토리 생성
mkdir -p src/LangLSP.Tests
cd src/LangLSP.Tests

# F# 콘솔 프로젝트 생성
dotnet new console -lang F# -n LangLSP.Tests

# Expecto 테스트 프레임워크 설치
dotnet add package Expecto --version 10.2.3
dotnet add package Expecto.FsCheck --version 10.2.3

# LangLSP.Server 프로젝트 참조
dotnet add reference ../LangLSP.Server/LangLSP.Server.fsproj

# 루트로 돌아가기
cd ../..

# 솔루션에 추가
dotnet sln add src/LangLSP.Tests/LangLSP.Tests.fsproj
</code></pre>
<h3 id="왜-expecto인가"><a class="header" href="#왜-expecto인가">왜 Expecto인가?</a></h3>
<ul>
<li><strong>F# 네이티브</strong>: F#으로 작성된 테스트 프레임워크</li>
<li><strong>표현력 높은 DSL</strong>: <code>testCase</code>, <code>testList</code>, <code>testProperty</code> 등</li>
<li><strong>FsCheck 통합</strong>: Property-based testing 지원</li>
<li><strong>FsAutoComplete 검증</strong>: FsAutoComplete 프로젝트에서도 사용 중</li>
</ul>
<h3 id="테스트-예시-phase-2에서-작성-예정"><a class="header" href="#테스트-예시-phase-2에서-작성-예정">테스트 예시 (Phase 2에서 작성 예정)</a></h3>
<pre><code class="language-fsharp">// LangLSP.Tests/ProtocolTests.fs
module ProtocolTests

open Expecto
open LangLSP.Server.Protocol
open Ast

[&lt;Tests&gt;]
let tests = testList "Protocol" [
    testCase "spanToLspRange converts 1-based to 0-based" &lt;| fun _ -&gt;
        let span = { FileName = "test.fun"; StartLine = 1; StartColumn = 1; EndLine = 1; EndColumn = 5 }
        let range = spanToLspRange span
        Expect.equal range.Start.Line 0u "Line should be 0-based"
        Expect.equal range.Start.Character 0u "Character should be 0-based"
]
</code></pre>
<hr>
<h2 id="빌드-및-실행-확인"><a class="header" href="#빌드-및-실행-확인">빌드 및 실행 확인</a></h2>
<p>모든 설정이 완료되었으면, 프로젝트가 정상적으로 빌드되는지 확인합니다.</p>
<h3 id="1-전체-솔루션-빌드"><a class="header" href="#1-전체-솔루션-빌드">1. 전체 솔루션 빌드</a></h3>
<pre><code class="language-bash"># 루트 디렉토리에서 실행
dotnet build

# 출력 예시:
#   Building...
#   FunLang -&gt; /path/to/LangTutorial/FunLang/bin/Debug/net10.0/FunLang.dll
#   LangLSP.Server -&gt; /path/to/src/LangLSP.Server/bin/Debug/net10.0/LangLSP.Server.dll
#   Build succeeded.
</code></pre>
<h3 id="2-서버-실행-테스트"><a class="header" href="#2-서버-실행-테스트">2. 서버 실행 (테스트)</a></h3>
<pre><code class="language-bash">dotnet run --project src/LangLSP.Server
</code></pre>
<p>서버가 시작되면 stdin 대기 상태가 됩니다.</p>
<p><strong>예상 동작:</strong></p>
<ul>
<li>콘솔에는 아무것도 출력되지 않음 (stdout은 LSP 프로토콜용)</li>
<li><code>/tmp/funlang-lsp.log</code> 파일에 로그가 기록됨</li>
</ul>
<p><strong>로그 확인:</strong></p>
<pre><code class="language-bash"># 로그 파일 확인 (Linux/macOS)
tail -f /tmp/funlang-lsp.log

# 출력 예시:
# 2025-02-04 15:20:01.123 +00:00 [INF] FunLang LSP Server starting...
# 2025-02-04 15:20:01.456 +00:00 [INF] Setting up LSP server on stdin/stdout
# 2025-02-04 15:20:01.789 +00:00 [INF] Server capabilities configured: ...
</code></pre>
<p><strong>종료:</strong></p>
<ul>
<li><code>Ctrl+C</code>로 서버 종료</li>
<li>또는 stdin을 닫으면 서버가 자동 종료</li>
</ul>
<h3 id="3-초기-파일-구조-확인"><a class="header" href="#3-초기-파일-구조-확인">3. 초기 파일 구조 확인</a></h3>
<p>프로젝트가 정상적으로 생성되었는지 확인합니다.</p>
<pre><code class="language-bash"># 프로젝트 구조 확인
tree -L 3 src/

# 출력:
# src/
# ├── LangLSP.Server
# │   ├── bin
# │   ├── obj
# │   ├── LangLSP.Server.fsproj
# │   ├── Program.fs
# │   ├── Protocol.fs
# │   └── Server.fs
# └── LangLSP.Tests
#     ├── bin
#     ├── obj
#     ├── LangLSP.Tests.fsproj
#     └── Program.fs
</code></pre>
<hr>
<h2 id="다음-단계"><a class="header" href="#다음-단계">다음 단계</a></h2>
<p>프로젝트 설정이 완료되었습니다! 이제 다음 작업들을 진행할 수 있습니다.</p>
<p><strong>Phase 1 - 다음 튜토리얼:</strong></p>
<ol>
<li><strong>04-document-sync.md</strong>: 문서 동기화 구현 (didOpen, didChange)</li>
<li><strong>05-diagnostics.md</strong>: 실시간 진단 발행 (TypeChecker 통합)</li>
</ol>
<p><strong>Phase 2 - LSP 기능 확장:</strong></p>
<ul>
<li>Hover (타입 정보 표시)</li>
<li>Completion (자동 완성)</li>
<li>Go to Definition</li>
<li>Find References</li>
</ul>
<p><strong>Phase 3 - VS Code 확장:</strong></p>
<ul>
<li><code>client/</code> 디렉토리에 VS Code 확장 프로젝트 생성</li>
<li>LSP 서버와 연동</li>
</ul>
<hr>
<h2 id="초기-파일-내용-참고"><a class="header" href="#초기-파일-내용-참고">초기 파일 내용 참고</a></h2>
<p>프로젝트 생성 후 각 파일의 초기 내용은 다음과 같습니다.</p>
<h3 id="protocolfs"><a class="header" href="#protocolfs">Protocol.fs</a></h3>
<pre><code class="language-fsharp">module LangLSP.Server.Protocol

open Ionide.LanguageServerProtocol.Types
open Ast  // FunLang's Span type

/// Convert FunLang Span (1-based) to LSP Range (0-based)
let spanToLspRange (span: Span) : Range =
    {
        Start = { Line = uint32 (span.StartLine - 1); Character = uint32 (span.StartColumn - 1) }
        End = { Line = uint32 (span.EndLine - 1); Character = uint32 (span.EndColumn - 1) }
    }

/// Convert FunLang Diagnostic to LSP Diagnostic
let diagnosticToLsp (diag: Diagnostic.Diagnostic) : Diagnostic =
    {
        Range = spanToLspRange diag.PrimarySpan
        Severity = Some DiagnosticSeverity.Error
        Code = None
        Source = Some "funlang"
        Message = diag.Message
        // ... (나머지 필드)
    }
</code></pre>
<h3 id="serverfs"><a class="header" href="#serverfs">Server.fs</a></h3>
<pre><code class="language-fsharp">module LangLSP.Server.Server

open Ionide.LanguageServerProtocol.Types

/// Server capabilities declaration
let serverCapabilities : ServerCapabilities =
    { ServerCapabilities.Default with
        TextDocumentSync =
            Some (U2.C1 {
                TextDocumentSyncOptions.Default with
                    OpenClose = Some true
                    Change = Some TextDocumentSyncKind.Incremental
            })
    }
</code></pre>
<h3 id="programfs"><a class="header" href="#programfs">Program.fs</a></h3>
<pre><code class="language-fsharp">module LangLSP.Server.Program

open System
open Serilog

[&lt;EntryPoint&gt;]
let main argv =
    // Serilog 설정
    Log.Logger &lt;-
        LoggerConfiguration()
            .MinimumLevel.Debug()
            .WriteTo.File("/tmp/funlang-lsp.log", rollingInterval = RollingInterval.Day)
            .CreateLogger()

    Log.Information("FunLang LSP Server starting...")

    // stdin/stdout 설정
    use input = Console.OpenStandardInput()
    use output = Console.OpenStandardOutput()

    // 서버 실행 대기
    // TODO: 다음 Phase에서 LSP 메시지 루프 구현

    0
</code></pre>
<hr>
<h2 id="참고-자료"><a class="header" href="#참고-자료">참고 자료</a></h2>
<ul>
<li><a href="https://docs.microsoft.com/dotnet/core/tools/">.NET CLI 공식 문서</a></li>
<li><a href="https://fsharp.org/guides/project-structure/">F# 프로젝트 구조</a></li>
<li><a href="https://github.com/ionide/LanguageServerProtocol">Ionide.LanguageServerProtocol GitHub</a></li>
<li><a href="https://github.com/haf/expecto">Expecto 문서</a></li>
<li><a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">Git Submodules 가이드</a></li>
</ul>
<hr>
<p><strong>→ 다음: <a href="./04-document-sync.html">04-document-sync.md</a></strong> - 문서 동기화 구현</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="02-library-choice.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="04-document-sync.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="02-library-choice.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="04-document-sync.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid-eefea253.min.js"></script>
        <script src="mermaid-init-ccf746f1.js"></script>



    </div>
    </body>
</html>
